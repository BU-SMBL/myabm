
<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Curvotaxis &#8212; MyABM vdev Manual</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/myabm.css?v=1e1bb860" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=4ea706d9"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/ortho/demo_curvotaxis';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Skeletal Cell Behaviors" href="demo_skeletal_cells.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="dev" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../_static/myabm_logo.png" class="logo__image only-light" alt="MyABM vdev Manual - Home"/>
    <img src="../../_static/myabm_logo.png" class="logo__image only-dark pst-js-only" alt="MyABM vdev Manual - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api.html">
    API Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/BU-SMBL/Tim-Josephson" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api.html">
    API Reference
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/BU-SMBL/Tim-Josephson" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../demo_life.html">Conway’s Game of Life</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demo_segregation.html">Schelling’s Model of Segregation</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="reference internal" href="index.html">Ortho Examples</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Ortho Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Curvotaxis</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-ortho-demo-curvotaxis-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="curvotaxis">
<span id="sphx-glr-examples-ortho-demo-curvotaxis-py"></span><h1>Curvotaxis<a class="headerlink" href="#curvotaxis" title="Link to this heading">#</a></h1>
<p>Cells have been shown to migrate in response to a variety of cues, including
chemical signaling (“chemotaxis”) and substrate/ECM stiffness (“durotaxis”).
<span id="id1">[<a class="reference internal" href="../../guide/ref.html#id2" title="Laurent Pieuchot, Julie Marteau, Alain Guignandon, Thomas Dos Santos, Isabelle Brigaud, Pierre François Chauvy, Thomas Cloatre, Arnaud Ponche, Tatiana Petithory, Pablo Rougerie, Maxime Vassaux, Jean Louis Milan, Nayana Tusamda Wakhloo, Arnaud Spangenberg, Maxence Bigerelle, and Karine Anselme. Curvotaxis directs cell migration through cell-scale curvature landscapes. Nature Communications, 9(1):1–13, sep 2018. URL: https://www.doi.org/10.1038/s41467-018-06494-6, doi:10.1038/s41467-018-06494-6.">PMG+18</a>]</span> demonstrated that cells also exhibit “curvotaxis”, or
curvature-dependent migration. Both migration rate and preferential migration
direction were demonstrated to be curvature dependent, which can be implemented
in the model by weighting the probability of migration by the curvature at
the cells current location and the probabilities of which site to move to by
the curvatures at the surrounding sites.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../src&#39;</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">myabm.ortho</span><span class="w"> </span><span class="kn">import</span> <span class="n">OrthoModel</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">setup</span><span class="p">,</span> <span class="n">geometries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mymesh</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
<section id="surface-geometry-for-demonstrating-curvotaxis">
<h2>Surface geometry for demonstrating curvotaxis<a class="headerlink" href="#surface-geometry-for-demonstrating-curvotaxis" title="Link to this heading">#</a></h2>
<p><span id="id2">[<a class="reference internal" href="../../guide/ref.html#id2" title="Laurent Pieuchot, Julie Marteau, Alain Guignandon, Thomas Dos Santos, Isabelle Brigaud, Pierre François Chauvy, Thomas Cloatre, Arnaud Ponche, Tatiana Petithory, Pablo Rougerie, Maxime Vassaux, Jean Louis Milan, Nayana Tusamda Wakhloo, Arnaud Spangenberg, Maxence Bigerelle, and Karine Anselme. Curvotaxis directs cell migration through cell-scale curvature landscapes. Nature Communications, 9(1):1–13, sep 2018. URL: https://www.doi.org/10.1038/s41467-018-06494-6, doi:10.1038/s41467-018-06494-6.">PMG+18</a>]</span> studied the migration of cells seeded on sinusoidal
substrates. These can be created by warping a 2D grid mesh to a sinusoidal
implicit function.
To sufficiently resolve the geometry of the sinusoidal surface, a smaller
grid size (0.005 mm) than the standard (0.025 mm) was used and the time
step was adjusted proportionally. While reducing the grid size alters
the contact inhibition of migration and allows for a locally higher than
normal cell density, the low seeding density of the cells on the surface
makes this impact negligible.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bounds</span></a> <span class="o">=</span> <span class="n">geometries</span><span class="o">.</span><span class="n">sinusoidal_surface</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">h</span></a> <span class="o">=</span> <span class="mf">.005</span> <span class="c1"># Grid spacing</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dt</span></a> <span class="o">=</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">h</span></a><span class="o">/</span><span class="mf">.025</span><span class="p">)</span>
<a href="https://bu-smbl.github.io/mymesh/generated/mymesh.mesh.html#mymesh.mesh" title="mymesh.mesh" class="sphx-glr-backref-module-mymesh sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surf</span></a> <span class="o">=</span> <a href="https://bu-smbl.github.io/mymesh/generated/submodules/mymesh.primitives.Grid2D.html#mymesh.primitives.Grid2D" title="mymesh.primitives.Grid2D" class="sphx-glr-backref-module-mymesh-primitives sphx-glr-backref-type-py-function"><span class="n">mymesh</span><span class="o">.</span><span class="n">primitives</span><span class="o">.</span><span class="n">Grid2D</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bounds</span></a><span class="p">[:</span><span class="mi">4</span><span class="p">],</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">h</span></a><span class="p">)</span>

<span class="c1"># Shape the surface</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">xnodes</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><a href="https://bu-smbl.github.io/mymesh/generated/mymesh.mesh.mesh.NNode.html#mymesh.mesh.mesh.NNode" title="mymesh.mesh.mesh.NNode" class="sphx-glr-backref-module-mymesh-mesh sphx-glr-backref-type-py-property"><span class="n">surf</span><span class="o">.</span><span class="n">NNode</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ynodes</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><a href="https://bu-smbl.github.io/mymesh/generated/mymesh.mesh.mesh.NNode.html#mymesh.mesh.mesh.NNode" title="mymesh.mesh.mesh.NNode" class="sphx-glr-backref-module-mymesh-mesh sphx-glr-backref-type-py-property"><span class="n">surf</span><span class="o">.</span><span class="n">NNode</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">constraints</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.column_stack.html#numpy.column_stack" title="numpy.column_stack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span></a><span class="p">((</span> <span class="c1"># Constrain the boundaries to</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">xnodes</span></a><span class="p">,</span> <span class="c1"># nodes</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.repeat.html#numpy.repeat" title="numpy.repeat" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">repeat</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">xnodes</span></a><span class="p">)),</span> <span class="c1"># axis</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">xnodes</span></a><span class="p">))</span> <span class="c1"># constraint value</span>
        <span class="p">)),</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.column_stack.html#numpy.column_stack" title="numpy.column_stack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span></a><span class="p">((</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ynodes</span></a><span class="p">,</span> <span class="c1"># nodes</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.repeat.html#numpy.repeat" title="numpy.repeat" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">repeat</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ynodes</span></a><span class="p">)),</span> <span class="c1"># axis</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ynodes</span></a><span class="p">))</span> <span class="c1"># constraint value</span>
        <span class="p">))</span>
    <span class="p">))</span>

<a href="https://bu-smbl.github.io/mymesh/generated/mymesh.mesh.html#mymesh.mesh" title="mymesh.mesh" class="sphx-glr-backref-module-mymesh sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surf</span></a> <span class="o">=</span> <a href="https://bu-smbl.github.io/mymesh/generated/submodules/mymesh.implicit.SurfaceNodeOptimization.html#mymesh.implicit.SurfaceNodeOptimization" title="mymesh.implicit.SurfaceNodeOptimization" class="sphx-glr-backref-module-mymesh-implicit sphx-glr-backref-type-py-function"><span class="n">mymesh</span><span class="o">.</span><span class="n">implicit</span><span class="o">.</span><span class="n">SurfaceNodeOptimization</span></a><span class="p">(</span><a href="https://bu-smbl.github.io/mymesh/generated/mymesh.mesh.html#mymesh.mesh" title="mymesh.mesh" class="sphx-glr-backref-module-mymesh sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surf</span></a><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">h</span></a><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                            <span class="n">constraint</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">constraints</span></a><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">InPlace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Identifying surface nodes...Done
</pre></div>
</div>
</section>
<section id="running-the-curvotaxis-simulation">
<h2>Running the curvotaxis simulation<a class="headerlink" href="#running-the-curvotaxis-simulation" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="../../generated/generated/submodules/myabm.ortho.actions.migrate_curvotaxis.html#myabm.ortho.actions.migrate_curvotaxis" title="myabm.ortho.actions.migrate_curvotaxis"><code class="xref py py-func docutils literal notranslate"><span class="pre">myabm.ortho.actions.migrate_curvotaxis()</span></code></a> agent action determines
the rate of migration and the direction of migration with a
curvature-dependent random walk process.</p>
<p>The migration rate is determined by the mean curvature at the node the cell
is currently on (<span class="math notranslate nohighlight">\(H_i\)</span>)by the equation:</p>
<div class="math notranslate nohighlight">
\[k = k_{m} \left(m_a m_b^{H_i} + m_c \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(k_m\)</span> is the baseline migration rate
(<code class="code docutils literal notranslate"><span class="pre">agent.parameters['MigrRate']</span></code>) and <span class="math notranslate nohighlight">\(m_a, \ m_b, \ m_c\)</span> are
migration weights (<code class="code docutils literal notranslate"><span class="pre">agent.parameters['MigrationWeight0']</span></code>,
<code class="code docutils literal notranslate"><span class="pre">agent.parameters['MigrationWeight1']</span></code>,
<code class="code docutils literal notranslate"><span class="pre">agent.parameters['MigrationWeight2']</span></code>). The default values
of these parameters were obtained by curve fitting to migration rate data
from <span id="id3">[<a class="reference internal" href="../../guide/ref.html#id2" title="Laurent Pieuchot, Julie Marteau, Alain Guignandon, Thomas Dos Santos, Isabelle Brigaud, Pierre François Chauvy, Thomas Cloatre, Arnaud Ponche, Tatiana Petithory, Pablo Rougerie, Maxime Vassaux, Jean Louis Milan, Nayana Tusamda Wakhloo, Arnaud Spangenberg, Maxence Bigerelle, and Karine Anselme. Curvotaxis directs cell migration through cell-scale curvature landscapes. Nature Communications, 9(1):1–13, sep 2018. URL: https://www.doi.org/10.1038/s41467-018-06494-6, doi:10.1038/s41467-018-06494-6.">PMG+18</a>]</span>: <span class="math notranslate nohighlight">\(k_m = 1\)</span>, <span class="math notranslate nohighlight">\(m_a = 0.101\)</span>,
<span class="math notranslate nohighlight">\(m_b = 1.083\)</span>, <span class="math notranslate nohighlight">\(m_c = 0.475\)</span>.</p>
<p>The migration direction is chosen based on the mean curvatures of the
neighboring nodes</p>
<div class="math notranslate nohighlight">
\[p(H_n) = 1 - \left(\frac{1}{1 + \exp(m_d(H_n - m_e))}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(m_d\)</span> and <span class="math notranslate nohighlight">\(m_e\)</span> are migration weights
(<code class="code docutils literal notranslate"><span class="pre">agent.parameters['MigrationWeight3']</span></code>,
<code class="code docutils literal notranslate"><span class="pre">agent.parameters['MigrationWeight4']</span></code>).  The default values were
determined by Bayesian optimization fitting the result of  simulations on
multiple different sinusoidal substrates to the experimental data of
<span id="id4">[<a class="reference internal" href="../../guide/ref.html#id2" title="Laurent Pieuchot, Julie Marteau, Alain Guignandon, Thomas Dos Santos, Isabelle Brigaud, Pierre François Chauvy, Thomas Cloatre, Arnaud Ponche, Tatiana Petithory, Pablo Rougerie, Maxime Vassaux, Jean Louis Milan, Nayana Tusamda Wakhloo, Arnaud Spangenberg, Maxence Bigerelle, and Karine Anselme. Curvotaxis directs cell migration through cell-scale curvature landscapes. Nature Communications, 9(1):1–13, sep 2018. URL: https://www.doi.org/10.1038/s41467-018-06494-6, doi:10.1038/s41467-018-06494-6.">PMG+18</a>]</span>: <span class="math notranslate nohighlight">\(m_d = 0.232 \ mm\)</span>, <span class="math notranslate nohighlight">\(m_e = -19.975 \ mm^{-1}\)</span></p>
<p>Since this example is only studying migration over a 1-day period, other
cell behaviors, like proliferation and apoptosis, can be neglected.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">OrthoModel</span><span class="p">(</span><a href="https://bu-smbl.github.io/mymesh/generated/mymesh.mesh.html#mymesh.mesh" title="mymesh.mesh" class="sphx-glr-backref-module-mymesh sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">surf</span></a><span class="p">)</span>
<span class="c1"># Scale the time step to be proportional with the grid spacing</span>
<span class="n">model</span><span class="o">.</span><span class="n">agent_grid</span><span class="o">.</span><span class="n">TimeStep</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dt</span></a>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span><span class="o">.</span><span class="n">model_parameters</span></a><span class="p">[</span><span class="s1">&#39;SubStep&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dt</span></a>
<span class="n">model</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;msc&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">agent_grid</span><span class="o">.</span><span class="n">ElemData</span><span class="p">[</span><span class="s1">&#39;Scaffold Fraction&#39;</span><span class="p">][:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">model</span><span class="o">.</span><span class="n">agent_grid</span><span class="o">.</span><span class="n">ElemData</span><span class="p">[</span><span class="s1">&#39;Volume Fraction&#39;</span><span class="p">][:]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Calculate curvatures</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k2</span></a> <span class="o">=</span> <a href="https://bu-smbl.github.io/mymesh/generated/submodules/mymesh.curvature.CubicFit.html#mymesh.curvature.CubicFit" title="mymesh.curvature.CubicFit" class="sphx-glr-backref-module-mymesh-curvature sphx-glr-backref-type-py-function"><span class="n">mymesh</span><span class="o">.</span><span class="n">curvature</span><span class="o">.</span><span class="n">CubicFit</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">NodeCoords</span></a><span class="p">,</span>
                                    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">NodeConn</span></a><span class="p">,</span>
                                    <a href="https://bu-smbl.github.io/mymesh/generated/mymesh.mesh.mesh.NodeNeighbors.html#mymesh.mesh.mesh.NodeNeighbors" title="mymesh.mesh.mesh.NodeNeighbors" class="sphx-glr-backref-module-mymesh-mesh sphx-glr-backref-type-py-property"><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">NodeNeighbors</span></a><span class="p">,</span>
                                    <a href="https://bu-smbl.github.io/mymesh/generated/mymesh.mesh.mesh.NodeNormals.html#mymesh.mesh.mesh.NodeNormals" title="mymesh.mesh.mesh.NodeNormals" class="sphx-glr-backref-module-mymesh-mesh sphx-glr-backref-type-py-property"><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">NodeNormals</span></a><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">agent_grid</span><span class="o">.</span><span class="n">NodeData</span><span class="p">[</span><span class="s1">&#39;Mean Curvature&#39;</span><span class="p">]</span> <span class="o">=</span> <a href="https://bu-smbl.github.io/mymesh/generated/submodules/mymesh.curvature.MeanCurvature.html#mymesh.curvature.MeanCurvature" title="mymesh.curvature.MeanCurvature" class="sphx-glr-backref-module-mymesh-curvature sphx-glr-backref-type-py-function"><span class="n">mymesh</span><span class="o">.</span><span class="n">curvature</span><span class="o">.</span><span class="n">MeanCurvature</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k2</span></a><span class="p">)</span>

<span class="c1"># Set actions</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span><span class="o">.</span><span class="n">agent_actions</span></a> <span class="o">=</span> <span class="p">(</span><span class="n">actions</span><span class="o">.</span><span class="n">migrate_curvotaxis</span><span class="p">,</span> <span class="p">)</span> <span class="c1"># Set cell actions</span>

<span class="c1"># Run the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">schedule</span><span class="o">=</span><span class="n">OrthoModel</span><span class="o">.</span><span class="n">substep_saver_schedule</span><span class="p">)</span>

<span class="c1"># Generate animation</span>
<span class="n">model</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="s1">&#39;curvotaxis.gif&#39;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">show_mesh_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">show_agents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_timer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">agent_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">render_points_as_spheres</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
            <span class="n">scalars</span><span class="o">=</span><span class="s1">&#39;Mean Curvature&#39;</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_demo_curvotaxis_001.gif" srcset="../../_images/sphx_glr_demo_curvotaxis_001.gif" alt="demo curvotaxis" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Identifying element edges...Done
/home/runner/work/myabm/myabm/src/myabm/ortho/__init__.py:90: UserWarning: Mesh has edges of unequal lengths. OrthoModel assumes a uniform grid.
  warnings.warn(&#39;Mesh has edges of unequal lengths. OrthoModel assumes a uniform grid.&#39;)
</pre></div>
</div>
</section>
<section id="comparison-to-experimental-data">
<h2>Comparison to experimental data<a class="headerlink" href="#comparison-to-experimental-data" title="Link to this heading">#</a></h2>
<p>The results of the simulation can be compared to the experimental results of
<span id="id5">[<a class="reference internal" href="../../guide/ref.html#id2" title="Laurent Pieuchot, Julie Marteau, Alain Guignandon, Thomas Dos Santos, Isabelle Brigaud, Pierre François Chauvy, Thomas Cloatre, Arnaud Ponche, Tatiana Petithory, Pablo Rougerie, Maxime Vassaux, Jean Louis Milan, Nayana Tusamda Wakhloo, Arnaud Spangenberg, Maxence Bigerelle, and Karine Anselme. Curvotaxis directs cell migration through cell-scale curvature landscapes. Nature Communications, 9(1):1–13, sep 2018. URL: https://www.doi.org/10.1038/s41467-018-06494-6, doi:10.1038/s41467-018-06494-6.">PMG+18</a>]</span>, which looked at the distribution of cells along the
surface, binning by height (which for these sinusoidal surfaces is linearly
correlated to mean curvature).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to the randomness of the model, the results can vary, but typically
averaging the results of a few repeated runs gives good agreement with
the experimental data.</p>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot histogram to compare to experimental data</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cellZ</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">NodeCoords</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span><span class="o">.</span><span class="n">history</span></a><span class="p">[</span><span class="s1">&#39;Agent Nodes&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hist</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">edges</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.histogram.html#numpy.histogram" title="numpy.histogram" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">histogram</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cellZ</span></a><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">))</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">centers</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">edges</span></a><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">edges</span></a><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">edges</span></a><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>

<span class="c1"># Experimental data from Pieuchot et al. (2018)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">average_height</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">])</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">percent_nuclei</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mf">59.6644</span><span class="p">,</span> <span class="mf">27.2483</span><span class="p">,</span> <span class="mf">10.8054</span><span class="p">,</span> <span class="mf">2.3490</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">percent_nuclei_std</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mf">6.1074</span><span class="p">,</span> <span class="mf">2.8188</span><span class="p">,</span> <span class="mf">1.8792</span><span class="p">,</span> <span class="mf">1.8792</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">colors</span></a> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#00007E&#39;</span><span class="p">,</span> <span class="s1">&#39;#1C15DB&#39;</span><span class="p">,</span> <span class="s1">&#39;#7E5E7E&#39;</span><span class="p">,</span> <span class="s1">&#39;#E1A92A&#39;</span><span class="p">,</span> <span class="s1">&#39;#F7E6C4&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bar_width</span></a> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">bar1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">centers</span></a><span class="o">*</span><span class="mi">1000</span><span class="o">-</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bar_width</span></a><span class="o">/</span><span class="mf">1.9</span><span class="p">,</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hist</span></a><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bar_width</span></a><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">colors</span></a><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">centers</span></a><span class="p">)],</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
    <span class="n">hatch</span><span class="o">=</span><span class="s1">&#39;////&#39;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulated&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">bar2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">average_height</span></a><span class="o">+</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bar_width</span></a><span class="o">/</span><span class="mf">1.9</span><span class="p">,</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">percent_nuclei</span></a><span class="p">,</span>
    <span class="n">yerr</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">percent_nuclei_std</span></a><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bar_width</span></a><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">colors</span></a><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">average_height</span></a><span class="p">)],</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pieuchot et al.&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Height (μm)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% o</span><span class="s1">f nuclei&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_demo_curvotaxis_002.png" srcset="../../_images/sphx_glr_demo_curvotaxis_002.png" alt="demo curvotaxis" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (1 minutes 51.275 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-ortho-demo-curvotaxis-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/70e44105236534207270193956021e06/demo_curvotaxis.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">demo_curvotaxis.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/436b71eeed0638bb0ddcfc0bcf3adeab/demo_curvotaxis.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">demo_curvotaxis.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/89f74f9abef5f9c1cf37bb1648a23184/demo_curvotaxis.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">demo_curvotaxis.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="demo_skeletal_cells.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Skeletal Cell Behaviors</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#surface-geometry-for-demonstrating-curvotaxis">Surface geometry for demonstrating curvotaxis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-curvotaxis-simulation">Running the curvotaxis simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-to-experimental-data">Comparison to experimental data</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/examples/ortho/demo_curvotaxis.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, Timothy O. Josephson.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>